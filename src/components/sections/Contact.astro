---
import FormInput from "../ui/FormInput.astro";
---

<section id="contacto" class="py-20 md:py-32 bg-white relative overflow-hidden">
    <div class="container mx-auto px-4 relative z-10">
        <div class="text-center mb-16">
            <span
                class="text-primary font-semibold tracking-wider uppercase text-sm mb-2 block"
                >Contáctanos</span
            >
            <h2
                class="text-3xl md:text-4xl font-extrabold text-text-primary mb-4"
            >
                ¿Listo para solucionar el problema?
            </h2>
            <p class="text-lg text-text-secondary max-w-2xl mx-auto">
                Completa el formulario y te contactaremos a la brevedad.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20">
            <!-- Formulario -->
            <div
                class="bg-white p-8 md:p-10 rounded-3xl shadow-2xl border border-gray-100 relative"
            >
                <div
                    class="absolute -top-10 -left-10 w-20 h-20 bg-primary/10 rounded-full blur-xl"
                >
                </div>
                <div
                    class="absolute -bottom-10 -right-10 w-20 h-20 bg-secondary/10 rounded-full blur-xl"
                >
                </div>

                <form
                    action="/api/sendQuote"
                    method="POST"
                    id="contact-form"
                    class="space-y-6 relative z-10"
                >
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <FormInput
                            type="text"
                            name="name"
                            label="Nombre Completo"
                            placeholder="Tu nombre"
                            required
                        />
                        <FormInput
                            type="tel"
                            name="phone"
                            label="Número de Teléfono"
                            placeholder="300 123 4567"
                            required
                        />
                    </div>

                    <FormInput
                        type="select"
                        name="appliance"
                        label="Tipo de Electrodoméstico"
                        required
                        options={[
                            "Nevera",
                            "Nevecon",
                            "Lavadora",
                            "Secadora / Lavaseca",
                            "Otro",
                        ]}
                    />
                    <FormInput
                        type="textarea"
                        name="message"
                        label="Describe tu problema"
                        placeholder="Ej: Mi nevera no enfría y hace un ruido raro."
                        required
                    />
                    <button
                        type="submit"
                        class="w-full bg-primary text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-primary-dark hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex items-center justify-center gap-2"
                    >
                        <svg
                            class="w-6 h-6"
                            fill="currentColor"
                            viewBox="0 0 32 32"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            ><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g
                                id="SVGRepo_tracerCarrier"
                                stroke-linecap="round"
                                stroke-linejoin="round"></g><g
                                id="SVGRepo_iconCarrier"
                            >
                                <title>whatsapp</title>
                                <path
                                    d="M26.576 5.363c-2.69-2.69-6.406-4.354-10.511-4.354-8.209 0-14.865 6.655-14.865 14.865 0 2.732 0.737 5.291 2.022 7.491l-0.038-0.070-2.109 7.702 7.879-2.067c2.051 1.139 4.498 1.809 7.102 1.809h0.006c8.209-0.003 14.862-6.659 14.862-14.868 0-4.103-1.662-7.817-4.349-10.507l0 0zM16.062 28.228h-0.005c-0 0-0.001 0-0.001 0-2.319 0-4.489-0.64-6.342-1.753l0.056 0.031-0.451-0.267-4.675 1.227 1.247-4.559-0.294-0.467c-1.185-1.862-1.889-4.131-1.889-6.565 0-6.822 5.531-12.353 12.353-12.353s12.353 5.531 12.353 12.353c0 6.822-5.53 12.353-12.353 12.353h-0zM22.838 18.977c-0.371-0.186-2.197-1.083-2.537-1.208-0.341-0.124-0.589-0.185-0.837 0.187-0.246 0.371-0.958 1.207-1.175 1.455-0.216 0.249-0.434 0.279-0.805 0.094-1.15-0.466-2.138-1.087-2.997-1.852l0.010 0.009c-0.799-0.74-1.484-1.587-2.037-2.521l-0.028-0.052c-0.216-0.371-0.023-0.572 0.162-0.757 0.167-0.166 0.372-0.434 0.557-0.65 0.146-0.179 0.271-0.384 0.366-0.604l0.006-0.017c0.043-0.087 0.068-0.188 0.068-0.296 0-0.131-0.037-0.253-0.101-0.357l0.002 0.003c-0.094-0.186-0.836-2.014-1.145-2.758-0.302-0.724-0.609-0.625-0.836-0.637-0.216-0.010-0.464-0.012-0.712-0.012-0.395 0.010-0.746 0.188-0.988 0.463l-0.001 0.002c-0.802 0.761-1.3 1.834-1.3 3.023 0 0.026 0 0.053 0.001 0.079l-0-0.004c0.131 1.467 0.681 2.784 1.527 3.857l-0.012-0.015c1.604 2.379 3.742 4.282 6.251 5.564l0.094 0.043c0.548 0.248 1.25 0.513 1.968 0.74l0.149 0.041c0.442 0.14 0.951 0.221 1.479 0.221 0.303 0 0.601-0.027 0.889-0.078l-0.031 0.004c1.069-0.223 1.956-0.868 2.497-1.749l0.009-0.017c0.165-0.366 0.261-0.793 0.261-1.242 0-0.185-0.016-0.366-0.047-0.542l0.003 0.019c-0.092-0.155-0.34-0.247-0.712-0.434z"
                                ></path>
                            </g></svg
                        >
                        Solicitar Cotización Gratis
                    </button>
                </form>
                <div id="form-status" class="mt-4 text-center font-medium">
                </div>
            </div>

            <!-- Info Card -->
            <div
                class="bg-white rounded-3xl shadow-2xl border border-gray-100 h-full flex flex-col overflow-hidden relative"
            >
                <div
                    class="absolute -top-10 -right-10 w-20 h-20 bg-primary/10 rounded-full blur-xl"
                >
                </div>
                <div
                    class="absolute -bottom-10 -left-10 w-20 h-20 bg-secondary/10 rounded-full blur-xl"
                >
                </div>

                <div class="p-8 md:p-10 relative z-10">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-8">
                        <div>
                            <h3
                                class="text-xl font-bold text-text-primary mb-4 flex items-center"
                            >
                                <div
                                    class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center mr-3 text-primary"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        ><path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                                        ></path></svg
                                    >
                                </div>
                                Horario
                            </h3>
                            <div
                                class="space-y-2 pl-3 border-l-2 border-gray-100"
                            >
                                <p class="text-text-secondary text-sm">
                                    Lunes a Viernes:<br /><span
                                        class="font-bold text-text-primary text-base"
                                        >8:00 AM – 6:00 PM</span
                                    >
                                </p>
                                <p class="text-text-secondary text-sm">
                                    Sábados:<br /><span
                                        class="font-bold text-text-primary text-base"
                                        >8:00 AM – 1:00 PM</span
                                    >
                                </p>
                            </div>
                        </div>
                        <div>
                            <h3
                                class="text-xl font-bold text-text-primary mb-4 flex items-center"
                            >
                                <div
                                    class="w-10 h-10 rounded-full bg-secondary/10 flex items-center justify-center mr-3 text-secondary"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        ><path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                                        ></path><path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                                        ></path></svg
                                    >
                                </div>
                                Cobertura
                            </h3>
                            <div class="pl-3 border-l-2 border-gray-100">
                                <p
                                    class="text-text-secondary text-sm leading-relaxed"
                                >
                                    Atendemos en todo <span
                                        class="font-bold text-text-primary"
                                        >Medellín</span
                                    >, Envigado, Sabaneta, Itagüí y Bello.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex-grow relative min-h-[300px] w-full">
                    <iframe
                        class="absolute inset-0 w-full h-full"
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d253840.6563599834!2d-75.69395254922616!3d6.24419888879599!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e4428dfb80fad05%3A0x42137cfcc7b53b56!2sMedell%C3%ADn%2C%20Antioquia!5e0!3m2!1ses!2sco!4v1678886458362!5m2!1ses!2sco"
                        style="border:0;"
                        allowfullscreen=""
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"
                    >
                    </iframe>
                </div>

                <div
                    class="bg-gray-50 p-4 text-center border-t border-gray-100 relative z-10"
                >
                    <a
                        href="https://goo.gl/maps/XXXXXX"
                        target="_blank"
                        class="inline-flex items-center text-sm text-primary font-bold hover:underline group"
                    >
                        Abrir en Google Maps
                        <svg
                            class="w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                            ><path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                            ></path></svg
                        >
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    /* mismo JS que tenías, solo asegúrate de que el archivo existe */
    const form = document.getElementById("contact-form");
    const status = document.getElementById("form-status");
    form?.addEventListener("submit", async (e) => {
        e.preventDefault();
        status.innerHTML = '<p class="text-blue-500">Enviando…</p>';
        try {
            const res = await fetch("/api/sendQuote", {
                method: "POST",
                body: JSON.stringify(Object.fromEntries(new FormData(form))),
                headers: { "Content-Type": "application/json" },
            });
            const data = await res.json();
            status.innerHTML = `<p class="${res.ok ? "text-green-600" : "text-red-600"}">${data.message}</p>`;
            if (res.ok) form.reset();
        } catch {
            status.innerHTML =
                '<p class="text-red-600">Error de red. Inténtalo de nuevo.</p>';
        }
    });
</script>
